<div id="photo_content" ng-controller="PhotoController" >
    <div id="photo_container">
        <shortcut></shortcut>
        <div  class="photo_controls" ng-show="showNextPrevButtons">
            <button  class="photo_controls_buttons" id="prev_button" ng-click="keyPressed({which: 37})">Prev</button>
            <button class="photo_controls_buttons" id="next_button" ng-click="keyPressed({which: 39})">Next</button>
        </div>

        
        <img ng-show="!photo.id || showPhotoLoading"style="position: absolute; top: 150px; left: 48% ;"
             src="../images/loading.gif" height="50" width="50" class="loading"/>
        <div ng-show="photo.id" class="photo">
            <div id="photo_img" >
                <img id="photo_image" ng-src="{{photo.url}}" alt=""/>
            </div>
            <div id="photo_info">
                <div class="photo_date">
                    {{getDisplayDate(photo.addingDate)}}
                </div>
                <div class="photo-likes-container">
                    <div id="photo_likes_count" class="count_widget"
                         ng-click="likePhoto()">
                        <span>{{photo.likesCount + " like it!"}}</span>
                        <span ng-show="photo.yourLike">&nbsp; including You</span>
                    </div>
                    <img ng-show="photo.likeLoading" src="../images/mini_loading.gif" style="float: left;"
                    height="20" width="20" class="loading_small"/>
                </div>
                <div class="set_as_avatar_button" >
                    <button ng-show="getCategory()=='avatar'" class="button" ng-click="setAsAvatar()">Set As Avatar</button>
                </div>
            </div>
            <div  class="photo_message">
                {{photo.message}}
            </div>
        </div>
    </div>
    <div style="
        width: 100%; background:#EFEFEF;
        padding-top: 15px;
        padding-bottom: 30px;
        display: inline-block;
        min-width: 100%;">
        <div class="photo_main_info_container">
            Published by
            <div class="photo_info_user">
                <a href="#?path=profile&id={{photo.user.id}}">
                    <div style="width: 50px; height: 50px; float: left;">
                        <thumbnail src="photo.user.avatar" size="50"/>
                    </div>
                </a>
                <div style="width: 185px; margin-left: 5px; float: left; word-wrap: break-word;">
                    <a href="#?path=profile&id={{photo.user.id}}">
                        {{photo.user.name + " " + photo.user.lastName}}
                    </a>
                </div>
            </div>
            <br />
            In photoquest
            <div class="photo_info_quest">
                <a href="#?path=quest&id={{photo.photoquestId}}">
                    <div style="width: 50px; height: 50px; float: left;">
                        <thumbnail src="photo.photoquest.avatar" size="50"/>
                    </div>
                </a>
                <div style="width: 185px;margin-left: 5px; float: left;word-wrap: break-word;">
                    <a href="#?path=quest&id={{photo.photoquestId}}">
                        {{photo.photoquest.name}}
                    </a>
                </div>
            </div>
        </div>
        <div class="comments_block" >
            <div class="comment_textarea_container">
                <form>
                    <div>
                        <textarea id="message_text_area" ng-model="message">

                        </textarea>
                    </div>
                    <div class="comment_button_container">
                        <img ng-show="putCommentLoading" src="../images/mini_loading.gif" style="position: relative; top: 5px;"
                             height="20" width="20" class="loading_small"/>
                        <button class="comment_button" ng-click="putComment()">Comment</button>
                    </div>
                </form>
            </div>

            <div id="comments_container"
                 ng-if="photo"
                 show-more-load="comments"
                 stopped="{{!photo || !photo.id || commentsUpdatingStopped}}"
                 show-more-id="show_more_comments_button"
                 limit="5"
                 ng-show="comments.length > 0"
                 url="//getCommentsOnPhoto?photoId={{photo.id}}"
                 reload-func-name="reloadComments"
                 class="wrapper">
                <div  class="single_comment" ng-repeat="comment in comments">
                    <div class="comment_user_photo">
                        <thumbnail size="50" src="comment.user.avatar"></thumbnail>
                    </div>
                    <div class="comment_text">
                        <a  class="commment_user_link" ng-href="#?profile_{{comment.user.id}}">
                            {{comment.user.name + " " + comment.user.lastName}}
                        </a><br />
                        <span class="comment_date">{{getDisplayDate(photo.addingDate)}}</span><br />
                        <div style="width: 420px; word-wrap: break-word; margin-top: 10px;" >
                            <span class="messages_text_font" style="font-size: 11pt;">
                                <a ng-href="#?path=profile&id={{comment.toUser.id}}"
                                   ng-show="comment.toUser" style="color: #428bca">
                                    {{comment.toUser.name}},
                                </a>
                                {{comment.message}}
                            </span>
                        </div>
                        <div class="comment_buttons" >
                            <div class="comment_likes_container">
                                <div class="count_widget comment_likes_count" ng-click="likeComment(comment)">
                                    <span>{{comment.likesCount + " like it!"}}</span>
                                    <span ng-show="comment.yourLike">&nbsp; including You</span>
                                </div>
                                <img ng-show="comment.likeLoading"
                                     src="../images/mini_loading.gif" height="20" width="20"
                                     class="loading_small"/>
                            </div>
                            <img src="../images/mini_loading.gif" style="margin-top: 2px; position:
                                relative; float: right;"
                                height="20" width="20" class="loading_small"/>
                            <a class="delete_button"  ng-show="isMineComment(comment)" ng-click="deleteComment(comment)">
                                Delete
                            </a>
                            <a ng-show="!comment.showReplyForm" class="reply_button" ng-click="reply(comment)">
                                Reply
                            </a>

                        </div>
                    </div>
                    <div ng-show="comment.showReplyForm" class="reply_form_container">
                        <div class="reply_form">
                            <textarea class="reply_message_text_area" ng-model="comment.replyMessage"></textarea>
                        </div>
                        <div class="comment_button_container">
                            <img ng-show="comment.replyCommentLoading" src="../images/mini_loading.gif" style="
                            position: relative;
                            top: 5px;"
                                 height="20" width="20" class="loading_small"/>
                            <button class="comment_button" ng-click="putComment(comment)">
                                Comment
                            </button>
                        </div>
                    </div>
                    
                </div>
                <div  class="show_more_button_container" >
                    <button id="show_more_comments_button" >
                        Show More
                    </button>
                </div>
            </div>
            <div style="width: 500px; text-align: center;">
                <img src="../images/loading.gif" height="50" width="50" class="loading"/>
            </div>
        </div>
    </div>
</div>